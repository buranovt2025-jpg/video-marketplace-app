# Техническое Задание: Video Marketplace MVP

**Версия:** 1.0  
**Дата:** 28 декабря 2024  
**Срок реализации:** 4-5 недель

---

## Описание проекта

Мобильная платформа для оптовых рынков города. Продавцы выставляют товары через рилсы, истории и карточки. Покупатели заказывают, курьеры доставляют напрямую от продавца к покупателю.

---

## Роли и права доступа

### Продавец
- [x] Регистрация/вход
- [ ] Профиль с адресом точки (локация)
- [ ] Создание карточек товаров
- [ ] Создание рилсов (видео)
- [ ] Создание историй (24 часа)
- [ ] Просмотр своих заказов
- [ ] Чат с покупателями
- [ ] Изменение статуса заказа (принят/готов к выдаче)

### Покупатель
- [x] Регистрация/вход
- [ ] Профиль с адресом доставки (локация)
- [ ] Просмотр ленты рилсов
- [ ] Просмотр историй (кружочки)
- [ ] Поиск (Instagram Explore style - сетка фото/видео)
- [ ] Просмотр карточек товаров
- [ ] Оформление заказа
- [ ] Отслеживание статуса заказа
- [ ] Чат с продавцом

### Курьер
- [x] Регистрация/вход
- [x] Просмотр доступных заказов
- [x] Принятие заказа
- [x] Просмотр адреса продавца (клик -> навигатор)
- [x] Просмотр адреса покупателя (клик -> навигатор)
- [x] Изменение статуса: Забрал -> В пути -> Доставлен
- [x] История выполненных заказов

### Админ
- [ ] Вход в систему
- [ ] Просмотр всех пользователей
- [ ] Просмотр всех заказов
- [ ] Изменение статусов заказов
- [ ] Модерация контента (удаление/бан)
- [ ] Создание рилсов для рекламы платформы
- [ ] Создание историй для рекламы платформы

---

## Функциональные модули

### 1. Авторизация и профили
- [x] Экран входа (email/пароль)
- [x] Экран регистрации с выбором роли
- [x] Ввод локации при регистрации (продавец/покупатель)
- [ ] Редактирование профиля
- [ ] Загрузка аватара

### 2. Контент (Рилсы, Истории, Карточки)
- [x] Лента рилсов (вертикальный скролл как TikTok)
- [x] Кружочки историй сверху (как Instagram)
- [ ] Просмотр историй (полноэкранный режим)
- [x] Создание рилса (запись/загрузка видео)
- [x] Создание истории (фото/видео на 24 часа)
- [x] Карточка товара (фото, название, цена, описание)
- [x] Привязка товара к рилсу/истории

### 3. Поиск (Instagram Explore)
- [x] Сетка фото/видео (не список)
- [ ] Поиск по названию товара
- [ ] Поиск по продавцу
- [ ] Фильтры (категория, цена)

### 4. Заказы
- [ ] Оформление заказа (товар + количество)
- [ ] Выбор способа оплаты (наличка курьеру)
- [ ] Подтверждение заказа
- [ ] Статусы заказа:
  - [ ] Создан
  - [ ] Принят продавцом
  - [ ] Готов к выдаче
  - [ ] Курьер забрал
  - [ ] В пути
  - [ ] Доставлен
- [ ] Уведомления о смене статуса

### 5. Чат
- [ ] Список диалогов
- [ ] Экран чата (сообщения)
- [ ] Отправка текста
- [ ] Отправка фото
- [ ] Push-уведомления о новых сообщениях

### 6. Навигация для курьера
- [x] Карточка заказа с двумя адресами
- [x] Кнопка "Открыть в навигаторе" (продавец)
- [x] Кнопка "Открыть в навигаторе" (покупатель)
- [x] Интеграция с Google Maps / Yandex Maps

### 7. Админ-панель
- [ ] Дашборд со статистикой
- [ ] Список пользователей
- [ ] Список заказов
- [ ] Модерация контента
- [ ] Создание рекламного контента

---

## Технический стек

### Frontend (Flutter)
- [x] Базовый проект настроен
- [x] GetX для state management
- [x] Демо-режим для тестирования UI
- [ ] Роутинг по ролям
- [ ] Экраны для всех ролей

### Backend (FastAPI)
- [x] FastAPI проект создан
- [x] In-memory база данных (для MVP)
- [ ] DigitalOcean Spaces для видео/фото
- [x] API авторизации (JWT + роли)
- [x] API контента (рилсы, истории, товары)
- [x] API заказов (state machine)
- [x] API чата (сообщения, диалоги)
- [ ] WebSocket для real-time (после MVP)

---

## План разработки

### Неделя 1: Инфраструктура и авторизация
- [x] Настройка FastAPI backend (in-memory DB для MVP)
- [x] Схема базы данных (models.py)
- [x] API авторизации (JWT + 4 роли)
- [x] API продуктов, контента, заказов, чата
- [ ] Flutter: экраны входа/регистрации
- [ ] Flutter: роутинг по ролям

### Неделя 2: Продавец - контент
- [x] API для рилсов, историй, карточек товаров
- [x] Flutter: создание рилса
- [x] Flutter: создание истории
- [x] Flutter: создание карточки товара
- [x] Flutter: профиль продавца
- [x] Flutter: API клиент для REST API
- [x] Flutter: экран входа/регистрации с ролями
- [x] Flutter: главный экран маркетплейса
- [x] Flutter: список товаров продавца

### Неделя 3: Покупатель - просмотр и заказ
- [x] Flutter: лента рилсов
- [x] Flutter: кружочки историй
- [x] Flutter: поиск (Explore grid)
- [x] Flutter: карточка товара (ProductDetailScreen)
- [x] Flutter: корзина (CartScreen с группировкой по продавцам)
- [x] Flutter: оформление заказа (CheckoutScreen)
- [x] Flutter: успешный заказ (OrderSuccessScreen)
- [x] Flutter: отслеживание заказа (OrderTrackingScreen)
- [x] Flutter: чат с продавцом/курьером (ChatScreen)
- [x] Интеграция с навигатором (Google Maps/Yandex Maps)

### Неделя 4: Чат и курьер
- [x] Flutter: экраны чата (ChatScreen)
- [x] Flutter: интерфейс курьера (CourierHomeScreen)
- [x] Flutter: детали заказа для курьера (CourierOrderDetailScreen)
- [x] Flutter: навигация к адресам (Google Maps/Yandex Maps)
- [x] Flutter: статусы заказа (picked_up, in_transit, delivered)
- [x] Flutter: роутинг по ролям (курьер -> CourierHomeScreen)
- [ ] API чата (WebSocket) - после MVP

### Неделя 5: Админ и тестирование
- [ ] Flutter: админ-панель
- [ ] Flutter: создание рекламного контента (админ)
- [ ] Тестирование всех сценариев
- [ ] Исправление багов
- [ ] Сборка релизного APK

---

## Дизайн

### Стиль: Instagram-like
- Кружочки историй сверху экрана
- Вертикальная лента рилсов (как TikTok)
- Поиск = сетка фото/видео (Explore)
- Карточки товаров визуальные (не как маркетплейс)

### Цветовая схема
- [ ] Определить основные цвета
- [ ] Создать UI kit

---

## Оплата

### MVP (наличка)
- [ ] Покупатель выбирает "Оплата наличными"
- [ ] Курьер принимает оплату при доставке
- [ ] Курьер отмечает "Оплачено"

### Будущее (онлайн)
- [ ] Интеграция Payme/Click (после MVP)

---

## Статус выполнения

**Общий прогресс:** ~80%

| Модуль | Статус | Прогресс |
|--------|--------|----------|
| Инфраструктура | Backend + Flutter API клиент готов | 95% |
| Авторизация | API + Flutter экраны готовы | 95% |
| Контент (Продавец) | API + Flutter экраны готовы | 85% |
| Поиск | API + базовый UI готов | 80% |
| Заказы | API + Flutter экраны готовы | 95% |
| Чат | API + Flutter экран готов | 85% |
| Курьер | API + Flutter экраны готовы | 95% |
| Админ | API готово | 40% |

---

## Точки возврата (Git)

| Дата | Коммит | Описание |
|------|--------|----------|
| 28.12.2024 | TBD | Неделя 4: Flutter экраны курьера |
| 28.12.2024 | 8526397 | Неделя 3: Flutter экраны покупателя |
| 28.12.2024 | 3c0a14a | Неделя 2: Flutter экраны продавца |
| 28.12.2024 | 08df202 | Неделя 1: Backend API готов |
| 28.12.2024 | 8c3b095 | Журнал и ТЗ MVP |
| 28.12.2024 | f010db5 | Демо-режим для тестирования UI |
| 24.12.2024 | 076efec | Исправления загрузки видео и профиля |

---

*Последнее обновление: 28 декабря 2024*
