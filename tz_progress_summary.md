# GoGoMarket — Progress Summary (30 Dec 2025)

## Текущее состояние прода (165.232.81.31)
- **Web статика**: nginx раздаёт из `/var/www/gogomarket` (Flutter Web build).
- **Backend API**: внешний `https://app-owphiuvd.fly.dev` (как минимум `/healthz` отвечает).

## Главная проблема #1 (белый экран) — закрыта частично
- **Было**: белый экран, иногда текст `165.232.81.31:50`.
- **Причина**: self‑signed SSL ломает регистрацию Service Worker + ранние ошибки старта были “тихими”.
- **Стало**: приложение стартует, видно **loading spinner** (т.е. Flutter уже рисует).

## Главная проблема #2 (зависание на загрузке) — причина найдена
- **Симптом**: бесконечный loader после старта.
- **Причина**: **401 Unauthorized** на `GET /api/auth/me` (токен протух/невалиден/не передаётся).
- **Фикс во фронте**: при сбросе токена и `currentUser == null` больше не зависаем на спиннере — **показываем экран логина**.

## Что уже сделано в коде (ветка `cursor/what-has-been-done-5e03`)
- **Диагностика старта**: показываем ошибку в UI + логируем в консоль (runZonedGuarded, FlutterError hooks).
- **Service Worker / PWA**:
  - отключена регистрация SW в `web/index.html` (plain `<script>` загрузка `main.dart.js`);
  - в `scripts/deploy_web.sh` по умолчанию `--pwa-strategy=none`.
- **Firebase init**: `Firebase.initializeApp()` в try/catch (не блокирует запуск, если web-конфиг не задан).
- **401 handling**: роутинг на логин вместо бесконечного спиннера.

## Что нужно протестировать после деплоя
- Открыть web: должен появиться **логин** (а не вечный loader), если `/api/auth/me` возвращает 401.
- Логин → убедиться, что токен сохраняется и `/api/auth/me` возвращает 200.

